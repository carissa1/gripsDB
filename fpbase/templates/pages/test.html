{% extends "base.html" %}
{% load static %}


{% block extrahead %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js" charset="utf-8"></script>
<script src="https://rawgit.com/misoproject/d3.chart/master/d3.chart.min.js"></script>
<script src="https://rawgit.com/annaghi/d3.chart.layout.hierarchy/master/d3.chart.layout.hierarchy.js"></script>
<style>
  html {
    display: table;
    margin: auto; }

  #lineage {
    width: 960px;
    height: 500px; }

  .node {
    cursor: pointer; }

  .node.leaf {
    cursor: default; }

  .node circle {
    fill: lightsteelblue;
    stroke: steelblue;
    stroke-width: 1.5px; }

  .node.leaf circle {
    fill: #fff; }

  .node text {
    font-size: 11px; }

  .link {
    fill: none;
    stroke: #ccc;
    stroke-width: 1.5px; }
</style>
{% endblock extrahead %}

{% block content %}

    <div class="container" id="lineage" style="border: 1px solid black;"></div>

{% endblock content %}

{% block javascript %}

<script type="text/javascript">
  function getData(){
    return {{tree|safe}};
  };
</script>

<script>
      (function() {
          var json = getData();
          var tree = d3.select("#lineage").append("svg")

           .chart("tree.cartesian")

              //.margin({ top: 0, right: 180, bottom: 0, left: 40 })
              .radius(function(d) { if( d.size ) return Math.log(d.size); else return 2; })
              .levelGap(80)
              //.sortable(function(a, b) { return d3.descending(a.size, b.size); })
              .zoomable([0.1, 3])
              .collapsible(12)
              //.duration(200)
              ;

           tree.draw(json);

      }());
    </script>

{% endblock javascript %}
